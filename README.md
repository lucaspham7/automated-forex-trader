# Automated Forex Trader

## Overview
A Python–MetaTrader4 automated trading system that executes forex trades based on external webhook alerts.  
The system receives buy/sell signals via a Flask webhook, validates them locally, and delivers approved trade instructions to MetaTrader4 using a file-based communication bridge.

This architecture enables fully automated trade execution while keeping MetaTrader4 isolated from direct network access.

---

## Architecture
External Alert  
→ Flask Webhook  
→ Python Validation  
→ Local Trade File  
→ MT4 Expert Advisor  
→ Trade Execution

---

## Project Structure
webhook_server.py # Flask server receiving webhook alerts

mt4_bridge.py # Python bridge writing trade instructions to MT4

mt4/ # MetaTrader4 Expert Advisor (MQL4)

---

## How It Works

### 1. Webhook Server (Flask)
- Exposes a `/webhook` POST endpoint
- Accepts JSON payloads containing a trade signal (`buy` or `sell`)
- Validates incoming requests before execution
- Passes approved signals to the MT4 bridge

### 2. Signal Validation & Time Window
- Trade execution is restricted to a predefined window (8:00 AM – 12:00 PM)
- Signals received outside this window are ignored
- Prevents unintended or off-hours trade execution

### 3. Python–MT4 File-Based Bridge
- Approved trade signals are written to a local file (`trade.txt`)
- File is placed inside the MT4 `MQL4/Files` directory
- Serves as a lightweight IPC mechanism between Python and MetaTrader4
- Avoids direct socket or network communication, aligning with MT4 sandbox constraints

### 4. Trade Execution (MetaTrader4 Expert Advisor)
- Continuously monitors a local trade instruction file generated by the Python webhook bridge  
- Parses buy/sell commands and validates symbol tradability and trading permissions  
- Enforces one active position per symbol by closing existing trades before executing new signals  
- Calculates dynamic position size based on account equity, configured risk percentage, and broker margin requirements  
- Executes market orders with slippage control and connection checks  
- Closes all open positions at a fixed daily cutoff time (12:00 PM local) using timer-based scheduling  
- Logs all trade actions and tracks realized profit per symbol and per day via persistent local files  

---

## Features
- Flask-based webhook receiver
- Secure, time-gated trade execution
- Python → MT4 file-based IPC bridge
- Fully automated buy/sell execution
- Dynamic risk-based position sizing
- Automated position reconciliation
- Scheduled trade liquidation
- Persistent P&L logging
